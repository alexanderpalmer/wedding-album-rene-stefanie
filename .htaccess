# Sicherheitsmaßnahmen für Produktionsumgebung

# Verhindern von Directory Browsing
Options -Indexes

# Sichere Session-Konfiguration
php_value session.cookie_httponly 1
php_value session.cookie_secure 0
php_value session.use_strict_mode 1
php_value session.cookie_samesite "Lax"

# Verstecken der PHP-Version
Header unset X-Powered-By

# Schutz vor Clickjacking
Header always append X-Frame-Options DENY

# XSS-Schutz
Header always set X-XSS-Protection "1; mode=block"

# Content-Type-Sniffing verhindern
Header always set X-Content-Type-Options nosniff

# Referrer Policy
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Zugriff auf sensible Dateien verhindern
<FilesMatch "\.(env|log|ini|conf|bak|old)$">
    Require all denied
</FilesMatch>

# Schutz vor Script-Injection
<FilesMatch "\.(php|phtml)$">
    <IfModule mod_headers.c>
        Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;"
    </IfModule>
</FilesMatch>